// the logic for the estimator